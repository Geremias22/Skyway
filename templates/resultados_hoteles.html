<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>üè® Hoteles en BCN</title>
  <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
  <nav style="background:#eef; padding:10px; margin-bottom:20px;">
    ‚úÖ {{ total_hotels }} hoteles encontrados en BCN<br>
    ‚úÖ Ofertas recibidas: {{ total_offers }}<br>
    Fechas: {{ check_in }} ‚Üí {{ check_out }}
  </nav>

  <ul>
  {% for h in hoteles if h.num_offers > 0 %}
    <li>
      <strong>{{ h.nombre }}</strong> ‚Äî Ofertas: {{ h.num_offers }}
      <button onclick="document.getElementById('detalles{{ loop.index }}').classList.toggle('hidden')">
        M√°s detalles
      </button>
      <div id="detalles{{ loop.index }}" class="hidden" style="margin:10px 0; padding:10px; border:1px solid #ccc;">
        {% for o in h.offers %}
          <h4>Oferta {{ loop.index }}</h4>
          <p><strong>Precio:</strong> {{ o.precio }} {{ o.moneda }}</p>
          <p><strong>Fechas:</strong> {{ o.checkin }} ‚Üí {{ o.checkout }}</p>
          <p><strong>Habitaciones:</strong> {{ o.room_quantity }}</p>
          <p><strong>Categor√≠a:</strong> {{ o.room_category }} ({{ o.beds }} camas)</p>
          <p><strong>Regimen:</strong> {{ o.board_type }}, c√≥digo tarifa {{ o.rate_code }}</p>
          <p><strong>Impuestos:</strong></p>
          <ul>
            {% for tax in o.taxes %}
              <li>{{ tax.code }}: {{ tax.amount or tax.percentage }} {{ tax.currency or "" }} {% if not tax.included %}(no incluido){% endif %}</li>
            {% endfor %}
          </ul>
          <p><strong>Pol√≠ticas de cancelaci√≥n:</strong></p>
          <ul>
            {% for pol in o.cancellation_policies %}
              <li>
                {% if pol.description %}
                  {{ pol.description.text }}
                {% elif pol.deadline %}
                  Hasta {{ pol.deadline }} ({{ pol.policyType }})
                {% else %}
                  {{ pol.policyType }}
                {% endif %}
              </li>
            {% endfor %}
          </ul>
          <p><strong>Pago:</strong> {{ o.payment_type }}</p>
          <p><strong>Descripci√≥n:</strong> {{ o.description }}</p>
          <hr>
        {% endfor %}

        <div class="google-info">
          {% if h.gm_address %}
            <p><strong>Direcci√≥n exacta:</strong> {{ h.gm_address }}</p>
          {% endif %}
          {% if h.gm_rating %}
            <p><strong>Valoraci√≥n Google:</strong> ‚≠ê {{ h.gm_rating }}</p>
          {% endif %}
          {% if h.gm_photos %}
            <div class="photo-gallery">
              {% for url in h.gm_photos %}
                <img src="{{ url }}" alt="Foto de {{ h.nombre }}" style="max-width:120px; margin:2px;">
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
    </li>
  {% else %}
    <li><em>No hay hoteles con ofertas disponibles.</em></li>
  {% endfor %}
</ul>

<style>
  .hidden { display: none; }
</style>
</body>
</html>
